import streamlit as st
import pandas as p


options_for_answers = [
'1. Cela est complètement faux pour moi.',
'2. Le plus souvent faux pour moi.',
'3. Plutôt vrai que faux pour moi.',
'4. Assez vrai pour moi.',
'5. Le plus souvent vrai pour moi.',
'6. Me décrit parfaitement.']

@st.cache
def get_questions():
    with open("./young-questions.txt", 'r') as fp:
        lines = fp.readlines()
    category = "1st_category"
    result_list = []
    for line in lines:
        line = line.strip()
        if len(line)<5:
            continue
        elif line[:2]=="*(":
            category = line.strip()
        elif line[0].isnumeric(): # if a ligne starts with a number the it should be a question
            if line.count('.')==0:
                continue
            question_number = line.split(".")[0]
            question_text = ".".join(line.split(".")[1:]).strip()
            
            result_list.append(
                (category,
                question_number,
                 question_text
                )
            )
    return result_list

st.title("Questionnaire de Young")

#result_list = get_questions()
#st.write(str(result_list))

result_list = [('(TOTO)', '1', "Les autres n'ont. pas satisfait mes besoins affectifs."), ('(TOTO)', '2', "Je n'ai pas reçu suffisamment d'amour et d'attention."), ('(TOTO)', '3', "Dans l'ensemble, je n'ai eu personne sur qui compter pour recevoir des conseils ou du soutien affectif."), ('(TOTO)', '4', "La plupart du temps, je n'ai eu personne pour m'aider à grandir, pour partager son univers intérieur avec moi, ou qui se soucie profondément de tout ce qui m'arrive."), ('(TOTO)', '5', "Pour la plus grande partie de ma vie, je n'ai eu personne qui veuille être près de moi et passer beaucoup de temps avec moi."), ('(TOTO)', '6', "En général, les autres n'ont pas été présents pour me prendre dans leurs bras, pour me donner de la chaleur et de l'affection."), ('(TOTO)', '7', "Pour la plus grande partie de ma vie, je n'ai jamais eu le sentiment que je représentais quelqu'un d'important pour quelqu'un d'autre."), ('(TOTO)', '8', "En grande partie, je n'ai eu personne qui m'écoute réellement, me comprenne et soit sensible à mes besoins et mes sentiments véritables."), ('(TOTO)', '9', "J'ai rarement eu une personne forte pour me donner de bons conseils ou pour me guider lorsque je ne savais pas quoi faire."), ('(ed)', '10', "Je suis préoccupé(e) par le fait que les gens que j'aime vont mourir bientôt même s'il y a peu de raisons médicales à ma préoccupation"), ('(ed)', '11', "Je m'accroche aux gens dont je suis proche par peur qu'ils ne me quittent."), ('(ed)', '12', "Je crains que les gens dont je me sens proche ne me quittent ou ne m'abandonnent."), ('(ed)', '13', "J'ai le sentiment de manquer d'une base stable qui me soutienne affectivement."), ('(ed)', '14', "Je n'ai pas l'impression que les relations importantes dureront : je m'attends à ce qu'elles finissent."), ('(ed)', '15', "Je me sens «accro» aux partenaires qui ne peuvent pas s'engager avec moi de façon stable."), ('(ed)', '16', ',Je finirai seul(e).'), ('(ed)', '17', "Quand je sens que quelqu'un à qui je tiens s'éloigne de moi, je deviens désespéré(e)."), ('(ed)', '18', "Quelquefois j'ai tellement peur que les gens m'abandonnent que je les repousse."), ('(ed)', '19', "Je deviens bouleversé(e) quand quelqu'un me laisse seul(e) même pour une courte période."), ('(ed)', '20', 'Je rie peux compter sur la présence régulière de ceux qui me soutiennent.'), ('(ed)', '21', "Je ne peux me permettre d'être vraiment proche des autres car je ne peux être sûr(e) qu'ils seront toujours là."), ('(ed)', '22', 'Il me semble que les personnes importantes dans ma vie sont toujours en train de venir et de repartir.'), ('(ed)', '23', "J'ai très peur que les personnes que j'aime ne trouvent quelqu'un d'autre qu'elles préfèrent et qu'elles m'abandonnent."), ('(ed)', '24', 'Les gens qui me sont proches ont toujours été très imprévisibles : un moment ils sont disponibles et gentils, puis, ils sont fâchés, contrariés, querelleurs, préoccupés par eux-mêmes...'), ('(ed)', '25', "J'ai tellement besoin des autres que j'ai peur de les perdre."), ('(ed)', '26', 'Je ne peux être moi-même ou exprimer ce que je ressens véritablement, sinon les autres vont me quitter.'), ('(ab)', '27', "J'ai l'impression que les autres vont profiter de moi."), ('(ab)', '28', "J'ai souvent l'impression que je dois me protéger des autres."), ('(ab)', '29', "J'ai l'impression que je dois être sur mes gardes en présence des autres"), ('(ab)', '30', "Si une personne est aimable avec moi, je suppose qu'elle cherche à"), ('(ab)', '31', "Ce n'est qu'une question de temps avant que quelqu'un me trahisse."), ('(ab)', '32', 'La plupart des gens pensent uniquement à eux.'), ('(ab)', '33', "J'ai la plus grande difficulté à faire confiance aux autres."), ('(ab)', '34', 'Je suis très méfiant(e) quant aux motivations des autres.'), ('(ab)', '35', "Les autres sont rarement honnêtes, ils ne sont pas en général ce qu'ils"), ('(ab)', '36', "Je m'interroge habituellement sur les véritables intentions des autres."), ('(ab)', '37', "Si je pense que quelqu'un cherche à me blesser, je cherche à le"), ('(ab)', '38', 'Les autres habituellement doivent faire leurs preuves avant que je leur'), ('(ab)', '39', "Je teste les autres pour voir s'ils me disent la vérité ou s'ils sont bien"), ('(ab)', '40', 'Je souscris à la croyance : «Contrôle ou tu seras contrôlé(e).»'), ('(ab)', '4 1 ', "Je me mets en colère quand je pense aux façons dont j'ai été maltraité(e)"), ('(ab)', '42', "Tout au long de ma vie, mes proches ont profité de moi et m'ont utilise(e)"), ('(ab)', '43', "J'ai été physiquement. émotionnellement, ou sexuellement abusé(e) par des personnes importantes de ma vie."), ('(ab)', '44', 'Je ne suis pas adapté(e).'), ('(ab)', '45', 'Je suis fondamentalement différent(e) des autres.'), ('(ab)', '46', 'Je suis à part; je suis un(e) solitaire.'), ('(ab)', '47', 'Je me sens étranger(ère) aux autres.'), ('(ab)', '48', 'Je me sens isolé(e) et seul(e).'), ('(ab)', '49', "Je me sens toujours à l'extérieur des groupes."), ('(ab)', '50', 'Personne ne me comprend vraiment.'), ('(ab)', '51', 'Ma famille a toujours été différente des autres familles.'), ('(ab)', '52', "rai parfois le sentiment d'être un étranger."), ('(ab)', '53', 'Si je disparaissais demain, personne ne le remarquerait.'), ('(si)', '54', "Aucun homme ou femme que je désire ne pourrait m'aimer une fois"), ('(si)', '55', 'Aucune personne que je désire ne pourrait rester proche de moi si'), ('(si)', '56', 'Je suis fondamentalement imparfait(e) et rnarqué(e) par un défaut.'), ('(si)', '57', "Même si je me donne le plus grand mal, je sens qu'il rie rie sera pas"), ('(si)', '58', "Je ne mérite pas l'amour. l'attention et le respect des autres."), ('(si)', '59', "J'ai le sentiment d'être quelqu'un que l'on rie peut pas aimer."), ('(si)', '60', 'Je suis trop fondamentalement inacceptable pour me révéler aux autres.'), ('(si)', '61', "Je ne pourrais pas affronter les gens, s'ils découvraient mes défauts"), ('(si)', '62', "Lorsque les gens m'apprécient. j'ai l'impression de les duper."), ('(si)', '63', 'Je suis souvent attiré(e) par les gens qui sont très critiques envers moi ou'), ('(si)', '64', "J'ai des secrets que je ne veux pas que rues proches découvrent."), ('(si)', '65', "C'est de ma faute si mes parents n'ont pas pu m'aimer suffisamment."), ('(si)', '66', 'Je ne laisse pas les gens connaître ce que je suis réellement.'), ('(si)', '67', 'Une de mes plus grandes peurs est que nies défauts deviennent publics.'), ('(si)', '68', "Je ne puis comprendre comment qui que ce soit pourrait m'aimer."), ('(si)', '69', "Presque rien de ce que je fais au travail (ou à l'école) n'est aussi bon que"), ('(si)', '70', "Je suis incompétent(e) quand il s'agit de réussir."), ('(si)', '71', 'La plupart des gens sont plus doués que moi en ce qui concerne le travail'), ('(si)', '72', 'Je suis un(e) raté(e).'), ('(si)', '73', "Je n'ai pas autant de talent que les autres au travail (ou à l'école)."), ('(si)', '74', "Je ne suis pas aussi intelligent (e) que la plupart des gens quand il s'agit du"), ('(si)', '75', 'Je suis humilié(e) par mes échecs ou mes insuffisances dans le monde du'), ('(si)', '76', "Je suis souvent mal à l'aise avec les autres. car je ne les vaux pas en"), ('(si)', '77', "Je compare souvent mes réalisations à celles des autres et je trouve qu'ils"), ('(fa)', '78', 'Je ne me sens pas capable de me débrouiller par moi-même dans la vie'), ('(fa)', '79', "J'ai besoin des autres pour m'aider à m'en sortir."), ('(fa)', '80', "Je n'ai pas le sentiment que je puisse bien m'adapter par moi-même."), ('(fa)', '81', 'Je crois que les autres peuvent prendre soin de moi mieux que je ne le'), ('(fa)', '82', "J'ai des difficultés à prendre en charge de nouvelles tâches en dehors du"), ('(fa)', '83', 'Je me considère comme une personne dépendante en ce qui concerne la'), ('(fa)', '84', "Je bousille tout ce que j'entreprends, même à l'extérieur du travail (ou de"), ('(fa)', '85', 'Je suis stupide dans la plupart des domaines de la vie.'), ('(fa)', '86', 'Si je me fie à mon jugement dans la vie de tous les jours, je vais prendre la'), ('(fa)', '87', 'Je manque de bon sens.'), ('(fa)', '88', 'On ne peut se fier à mon jugement dans les situations quotidiennes.'), ('(fa)', '89', "Je n'ai pas confiance dans ma capacité à résoudre les problèmes qui se"), ('(fa)', '90', "Je pense avoir besoin de quelqu'un sur qui je puisse compter pour me"), ('(fa)', '91', "Je me sens plus un(e) enfant qu'un(e) adulte quand il s'agit de prendre en"), ('(fa)', '92', 'Je me sens dépassé(e) par les responsabilités de tous les jours.'), ('(di)', '93', "Il ne me semble pas possible d'échapper au sentiment que quelque chose"), ('(di)', '94', "J'ai l'impression qu'un désastre naturel, criminel, financier ou médical"), ('(di)', '95', "J'ai peur de devenir un(e) sans domicile fixe ou un (e) mendiant(e)."), ('(di)', '96', "J'ai peur d'être attaqué(e)."), ('(di)', '97', "Je prends de grandes précautions pour éviter de tomber malade ou d'être"), ('(di)', '98', "J'ai peur d'avoir une maladie grave, même si rien de sérieux n'a été"), ('(di)', '99', "Je suis quelqu'un de peureux(se)."), ('(di)', '100', 'Je me soucie beaucoup de ce qui va mal dans le monde : le crime,'), ('(di)', '101', "J'ai souvent le sentiment que je pourrais devenir fou (folle)."), ('(di)', '102', "J'ai souvent l'impression que je vais avoir une crise d'angoisse."), ('(di)', '103', "J'ai souvent peur d'avoir une crise cardiaque ou un cancer, même s'il y a peu"), ('(di)', '104', 'Je pense que le monde est un endroit dangereux.'), ('(vu)', '105', "Je n'ai pas pu me séparer de ma mère ou de mon pbre comme semblent"), ('(vu)', '106', 'Mes parents et moi avons tendance à être sur-impliqués dans nos vies et'), ('(vu)', '107', 'Il est très difficile, pour mes parents et moi-même, de garder secrets.'), ('(vu)', '108', "Mes parents et moi devons nous parler presque tous les jours, sinon l'un"), ('(vu)', '109', "J'ai souvent l'impression de ne pas avoir une identité distincte de celle de"), ('(vu)', '110', "J'ai souvent l'impression que mes parents vivent à travers moi je n'ai pas"), ('(vu)', '111', "Il m'est vraiment ardu de maintenir une distance vis-à-vis des gens dont je"), ('(vu)', '112', 'Je suis tellement lié(e) à mon partenaire ou à mes parents que je ne sais'), ('(vu)', '113', "J'éprouve des difficultés à distinguer mon point de vue ou mon opinion de"), ('(vu)', '114', "J'ai souvent l'impression de ne pas avoir d'intimité par rapport à mes"), ('(vu)', '115', 'Je sens que mes parents seraient vraiment peinés si je vivais seul(e), loin'), ('(vu)', '116', "Je laisse les autres faire ce qu'ils veulent, car j'ai peur des conséquences."), ('(vu)', '117', 'Je pense que si je fais ce que je veux, je cours après les problèmes.'), ('(vu)', '118', "Je sens que je n'ai pas d'autre choix que de me soumettre aux souhaits"), ('(vu)', '119', "Dans mes relations, je laisse l'autre avoir le dessus sur moi."), ('(vu)', '120', 'Je laisse toujours les autres choisir à ma place, si bien que je ne sais pas'), ('(vu)', '121', "J'ai le sentiment que les décisions importantes de ma vie n'étaient pas"), ('(vu)', '122', "Je me soucie beaucoup de plaire aux autres. pour qu'ils ne me rejettent"), ('(vu)', '123', "J'ai beaucoup de difficultés à exiger que mes droits soient respectés et que"), ('(vu)', '124', 'Plutôt que manifester ouvertement ma colère, je me venge dans des'), ('(vu)', '125', 'Je vais tolérer beaucoup plus de choses que la plupart des gens afin'), ('(sb)', '126', 'Je fais passer les besoins des autres avant les miens, sinon je me sens coupable.'), ('(sb)', '127', 'Je me sens coupable si je laisse tomber les autres ou si je les déçois.'), ('(sb)', '128', 'Je donne davantage aux autres que je ne reçois en retour.'), ('(sb)', '129', 'Je suis celui (celle) qui finit généralement par prendre soin des gens dont'), ('(sb)', '130', "Il n'y a presque rien que je ne puisse supporter lorsque j'aime quelqu'un."), ('(sb)', '131', "Je suis quelqu'un de bon car je pense aux autres plus qu'à moi-même."), ('(sb)', '132', 'Au travail, je suis habituellement celui (celle) qui est volontaire pour faire'), ('(sb)', '133', 'Même si je suis très occupé(e), je trouve toujours du temps pour les'), ('(sb)', '134', "Je peux m'en sortir avec vraiment très peu car mes besoins sont minimes."), ('(sb)', '135', "Je ne suis heureux(se) que si les gens qui m'entourent le sont aussi."), ('(sb)', '13G', "Je suis tellement occupé(e) à me dévouer pour les gens qui m'importent"), ('(sb)', '137', "J'ai toujours été celui (celle) qui écoute les problèmes des autres."), ('(sb)', '138', "Je me sens plus à l'aise pour donner un cadeau que pour en recevoir un."), ('(sb)', '139', "On me voit comme quelqu'un qui en fait trop pour les autres et"), ('(sb)', '140', "Peu importe combien je donne, ce n'est jamais assez."), ('(sb)', '141', "Si je fais ce que je veux, je me sens vraiment. mal à l'aise."), ('(sb)', '142', "Il m'est vraiment difficile de demander aux autres de se soucier de mes"), ('(ss)', '143', "J'ai peur de perdre le contrôle de mes actes."), ('(ss)', '144', "J'ai peur de faire du mal à quelqu'un, physiquement ou affectivement. si je"), ('(ss)', '145', 'Je sens que je dois contrôler mes émotions et mes impulsions, sinon'), ('(ss)', '146', "J'en arrive à accumuler en moi beaucoup de colère et de ressentiment que"), ('(ss)', '147', 'Je suis trop gêné(e) pour exprimer des sentiments positifs aux autres (par'), ('(ss)', '148', "Je trouve embarrassant d'exprimer mes sentiments aux autres."), ('(ss)', '149', "Il m'est difficile d'être chaleureux (se) et spontané(e)."), ('(ss)', '150', "Je me contrôle tellement bien que les autres croient que je n'ai pas"), ('(ss)', '151', 'Les gens me trouvent coincé(e) sur le plan émotionnel.'), ('(ei)', '152', 'Je dois être le (la) meilleur (e) dans presque tout ce que je fais, je ne peux'), ('(ei)', '153', "Je m'efforce de tout maintenir parfaitement en ordre."), ('(ei)', '154', 'Je dois apparaître sous mon meilleur aspect la plupart du temps.'), ('(ei)', '155', "Je m'efforce de faire de mon mieux; je ne peux pas me contenter"), ('(ei)', '156', "J'ai tant de choses à faire qu'il ne me reste presque pas de temps pour me"), ('(ei)', '157', "Presque rien de ce que je fais n'est assez bien, je pourrais toujours"), ('(ei)', '158', 'Je dois faire face à toutes mes responsabilités.'), ('(ei)', '159', 'Je ressens une pression constante qui me force à faire les choses et à les'), ('(ei)', '160', "Mes relations souffrent de ce que je m'impose trop de choses."), ('(ei)', '161', "Je m'impose une telle pression pour bien faire que ma santé en souffre."), ('(ei)', '162', 'Souvent je sacrifie plaisir et bonheur pour atteindre mes idéaux.'), ('(ei)', '163', 'Lorsque je fais une erreur, je mérite une critique sévère.'), ('(ei)', '164', "Je ne peux pas accepter de me dégager aisément d'une situation' difficile ou"), ('(ei)', '165', "Je suis quelqu'un de très compétitif."), ('(ei)', '166', "J'attache beaucoup d'importance à l'argent ou au statut social."), ('(ei)', '167', "Je tiens toujours à être le (la) meilleur (e) dans ce que j'accomplis."), ('(ei)', '168', "Lorsque j'attends quelque chose des autres, j'ai beaucoup de difficulté à"), ('(ei)', '169', "Je me mets souvent en colère ou je m'irrite quand je rie peux pas avoir ce"), ('(ei)', '170', "je suis quelqu'un de spécial et je ne devrais pas avoir à accepter les"), ('(ei)', '171', "Je déteste être contraint(e) ou qu'on m'empêche de faire ce que je veux."), ('(ei)', '172', "Je crois que je n'ai pas à suivre les règles et les conventions comme les"), ('(ei)', '173', "J'ai le sentiment que j'ai beaucoup plus à offrir que les autres."), ('(ei)', '174', 'Habituellement, je fais passer mes besoins avant ceux des autres.'), ('(ei)', '175', "Je remarque souvent que l'importance accordée à mes priorités"), ('(ei)', '176', 'Les autres me disent souvent que je contrôle trop la façon dont les choses'), ('(ei)', '177', 'Je suis très irrité(e) lorsque les autres ne font pas ce que je leur demande.'), ('(ei)', '178', 'Je ne supporte pas que les autres me disent ce que je dois faire.'), ('(et)', '179', "J'ai beaucoup de difficultés à m'arrêter de boire, de fumer, de trop manger"), ('(et)', '180', 'Il ne me semble pas possible de me discipliner pour terminer des tâches'), ('(et)', '181', 'Souvent, je me laisse aller à mes impulsions ou à exprimer des émotions'), ('(et)', '182', 'Si je ne peux pas atteindre un but, je suis facilement frustré(e) et'), ('(et)', '183', "11 m'est très difficile de sacrifier une gratification immédiate pour mener à bien"), ('(et)', '184', 'Quand je me mets en colère, il est fréquent que je ne puisse pas du tout'), ('(et)', '185', "J'ai tendance à abuser de certaines choses. même si je sais que c'est"), ('(et)', '186', "Je m'ennuie très facilement."), ('(et)', '187', 'Quand les tâches deviennent difficiles, je ne peux souvent pas persévérer'), ('(et)', '188', 'Je ne peux pas me concentrer longtemps sur quoi que ce soit.'), ('(et)', '189', 'Je ne peux pas me forcer à faire des choses qui ne me plaisent pas même'), ('(et)', '190', 'Je me mets en colère à la moindre offense.'), ('(et)', '191', "J'ai rarement été capable de tenir mes engagements."), ('(et)', '192', "Je ne peux presque jamais m'empêcher de montrer aux gens mes"), ('(et)', '193', "J'agis souvent impulsivement et je le regrette plus tard."), ('(is)', '194', "Il m'est important d'être aimé(e) par presque tous ceux que je connais."), ('(is)', '195', 'Je modifie mon comportement en fonction des gens avec qui je me trouve.'), ('(is)', '196', "Je fais tout mon possible pour m'adapter."), ('(is)', '197', 'Mon estime personnelle est principalement fondée sur la façon dont les'), ('(is)', '198', "Posséder de l'argent et connaître des gens importants sont des choses qui"), ('(is)', '199', 'Je consacre beaucoup de temps à soigner mon apparence afin de gagner'), ('(is)', '200', 'Mes réussites ont plus de valeur à mes yeux si les autres les'), ('(is)', '201', "Je suis à ce point soucieux(e) de m'adapter aux autres qu'il m'arrive de"), ('(is)', '202', 'Je trouve difficile de me fixer des objectifs propres, sans prendre en'), ('(is)', '203', "Lorsque je considère les décisions que j'ai prises dans ma vie, je réalise que"), ('(is)', '204', "Même si je n'aime pas une personne, je tiens malgré tout à ce qu'elle"), ('(is)', '205', "À moins d'obtenir beaucoup d'attention des autres, je me sens peu"), ('(is)', '206', "Si j'interviens lors d'une réunion ou si on me présente dans un groupe, je"), ('(is)', '207', "Lorsqu'on me fait beaucoup de compliments et d'éloges, je me sens une"), ('(as)', '208', "Même lorsque tout va bien, j'ai l'impression que ce ne sera que temporaire."), ('(as)', '209', "S'il se produit quelque chose de bien, j'ai peur qu'il n'arrive ensuite"), ('(as)', '210', "On n'est jamais assez prudent; il peut toujours se produire quelque chose"), ('(as)', '211', "Même si je travaille beaucoup, j'ai peur de nie retrouver un jour sans le"), ('(as)', '212', "J'ai peur qu'une mauvaise décision ne puisse conduire à un désastre."), ('(as)', '213', 'Je me tourmente souvent pour des décisions mineures, car les'), ('(as)', '214', 'Je préfère considérer que les choses ne vont pas aller comme je le veux,'), ('(as)', '215', "Je pense plutôt aux aspects négatifs de la vie et des évènements qu'aux"), ('(as)', '216', "J'ai tendance à être pessimiste."), ('(as)', '217', 'Mes proches considèrent que je me fais trop de soucis.'), ('(as)', '218', "Si les gens s'enthousiasment trop, je me sens mal et j'éprouve le besoin de"), ('(np)', '219', "Si je fais une erreur, je mérite d'être puni (e)."), ('(np)', '220', "Si je ne donne pas le meilleur de moi-même, je dois m'attendre à échouer."), ('(np)', '221', "Je n'ai aucune excuse si je fais une erreur."), ('(np)', '222', 'Les gens qui ne font pas leur part de travail à fond devraient être punis'), ('(np)', '223', "La plupart du temps, je n'accepte pas les excuses des autres : ils n'ont pas"), ('(np)', '225', 'Je pense souvent à mes erreurs passées et je me mets en colère contre'), ('(np)', '226', "Lorsque les gens font quelque chose de mal, j'ai du mal à appliquer la"), ('(np)', '227', "Je garde de la rancune envers les gens, même s'ils se sont excusés."), ('(np)', '228', "Je me sens énervé(e) à l'idée que quelqu'un s'est tiré trop facilement d'un"), ('(np)', '229', 'Je me mets en colère lorsque des gens se trouvent des excuses, ou'), ('(np)', '230', 'Peu importe les raisons, quand je fais une erreur, je devrais en payer le'), ('(np)', '231', "Je m'en veux énormément lorsque je bousille quelque chose."), ('*(np)', '232', "Je suis quelqu'un de mauvais qui mérite d'être puni.")]

df = p.DataFrame(result_list, columns=["category", "question_number", "question_text"])

answers_dict = {}
for index, q in df.iterrows():
    st.caption(f"question {q.question_number}:")
    answers_dict[q.question_number] = st.selectbox(q.question_text, ['']+options_for_answers)

run  = st.button("Calculer le résultat")

if run:
    df.loc[:, "answer"] = df.question_number.map(answers_dict)
    df.loc[df.answer=='', "answer"] = "0.Not answered"
    df.loc[:,"answer_short"] = df.answer.map(lambda x: "A"+x.split(".")[0])
    unanswered_questions = df.loc[df.answer.str.startswith("0.Not answered")].question_number.values
    if len(unanswered_questions)>0:
        unanswered_questions_str = ", ".join(["question_"+x for x in unanswered_questions])
        st.error("Vous n'avez pas répondu aux questions suivantes : "+unanswered_questions_str)

    df_analysis = df.groupby("category").answer.value_counts()
    st.subheader("Tableau des résultats:")
    st.write(df_analysis)
    results_analysis = df_analysis.to_string()
    results_report = results_analysis + f"\n\n" + df[["category", "question_number", "answer_short", "question_text"]].to_string()

    st.download_button('Télécharger la synthèse', results_report)




